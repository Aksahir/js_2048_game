const t=new class{statusEnum={idle:"idle",playing:"playing",win:"win",lose:"lose"};constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.initialState=t,this.state=this.initialState.map(t=>t.slice()),this.status=this.statusEnum.idle,this.score=0}moveUp(){if(this.status===this.statusEnum.playing){let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=0;t<4;t++)0!==this.state[t][e]&&s.push(this.state[t][e]);for(let e=0;e<s.length;e++)s[e]===s[e+1]&&(s[e]*=2,s[e+1]=0,this.score+=s[e],t=!0);let i=s.filter(t=>0!==t);for(;i.length<4;)i.push(0);for(let s=0;s<4;s++)this.state[s][e]!==i[s]&&(this.state[s][e]=i[s],t=!0)}t&&(this.addTile(),this.checkStatus())}}moveDown(){if(this.status===this.statusEnum.playing){let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=3;t>=0;t--)0!==this.state[t][e]&&s.push(this.state[t][e]);for(let e=0;e<s.length;e++)s[e]===s[e+1]&&(s[e]*=2,s[e+1]=0,t=!0,this.score+=s[e]);let i=s.filter(t=>0!==t);for(;i.length<4;)i.push(0);for(let s=0;s<4;s++)this.state[s][e]!==i[3-s]&&(this.state[s][e]=i[3-s],t=!0)}t&&(this.addTile(),this.checkStatus())}}moveLeft(){if(this.status===this.statusEnum.playing){let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=0;t<4;t++)0!==this.state[e][t]&&s.push(this.state[e][t]);for(let e=0;e<s.length;e++)s[e]===s[e+1]&&(s[e]*=2,s[e+1]=0,t=!0,this.score+=s[e]);let i=s.filter(t=>0!==t);for(;i.length<4;)i.push(0);for(let s=0;s<4;s++)this.state[e][s]!==i[s]&&(this.state[e][s]=i[s],t=!0)}t&&(this.addTile(),this.checkStatus())}}moveRight(){if(this.status===this.statusEnum.playing){let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=3;t>=0;t--)0!==this.state[e][t]&&s.push(this.state[e][t]);for(let e=0;e<s.length;e++)s[e]===s[e+1]&&(s[e]*=2,s[e+1]=0,t=!0,this.score+=s[e]);let i=s.filter(t=>0!==t);for(;i.length<4;)i.push(0);for(let s=0;s<4;s++)this.state[e][s]!==i[3-s]&&(this.state[e][s]=i[3-s],t=!0)}t&&(this.addTile(),this.checkStatus())}}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.status=this.statusEnum.playing,this.addTile(),this.addTile()}restart(){this.status=this.statusEnum.idle,this.state=this.initialState.map(t=>t.slice()),this.score=0}addTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.state[e][s]&&t.push([e,s]);if(t.length>0){let[e,s]=t[Math.floor(Math.random()*t.length)];this.state[e][s]=.9>Math.random()?2:4}}checkStatus(){let t=!1,e=!1;for(let s=0;s<4;s++)for(let i=0;i<4;i++){if(2048===this.state[s][i]){this.status=this.statusEnum.win;return}0===this.state[s][i]&&(e=!0),(s<3&&this.state[s][i]===this.state[s+1][i]||i<3&&this.state[s][i]===this.state[s][i+1])&&(t=!0)}e||t||(this.status=this.statusEnum.lose)}},e=document.querySelector(".start"),s=document.querySelector(".message-start"),i=document.querySelector(".message-win"),a=document.querySelector(".message-lose"),l=document.querySelector(".game-field"),h=document.querySelector(".game-score");function r(){h.textContent=t.getScore()}function n(){l.innerHTML="";let e=t.getState();for(let t=0;t<e.length;t++){let s=document.createElement("tr");for(let i=0;i<e[t].length;i++){let a=document.createElement("td"),l=e[t][i];a.textContent=0!==l?l:"",a.classList.add("field-cell"),0!==l&&a.classList.add(`field-cell--${l}`),s.appendChild(a)}l.appendChild(s)}}e.addEventListener("click",()=>{"Start"===e.textContent?(t.start(),s.classList.add("hidden"),e.classList.remove("start"),e.textContent="Restart",e.classList.add("restart")):"Restart"===e.textContent&&(t.restart(),i.classList.add("hidden"),a.classList.add("hidden"),e.textContent="Start",e.classList.add("start"),e.classList.remove("restart"),s.classList.remove("hidden")),n(),r()}),document.addEventListener("keydown",function(e){switch(e.key){case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight()}n(),r(),t.getStatus()===t.statusEnum.win&&i.classList.remove("hidden"),t.getStatus()===t.statusEnum.lose&&a.classList.remove("hidden")});
//# sourceMappingURL=index.2ecb0959.js.map
